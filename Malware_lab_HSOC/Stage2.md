
```
sudo mount -t ntfs-3g -o loop,ro,show_sys_files,stream_interface=windows,offset=$((2048*512)) ./challenge /mnt/windows/
```


- Q1
    
    What is the computer's name?
    

![[Pasted image 20230712223643.png]]
```
sudo vol -f memdump.mem windows.envars | grep -i computername
```
![[Pasted image 20230712223755.png]]
```
~/Downloads/volatility_2.6_lin64_standalone/volatility_2.6_lin64_standalone -f memdump.mem --profile=Win2008SP1x86 printkey -K "ControlSet001\Control\ComputerName\ComputerName"
```
![[Pasted image 20230712223840.png]]
```
regripper -r /mnt/windows/Windows/System32/config/SYSTEM -p compname
```

- Q2
    
    What was the first vulnerability the attacker was able to exploit?
    

![[Pasted image 20230623025054.png]]
```
\xampp\apache\logs\access.log
```

- Q3
    
    How many users are on the compromised machine?
    

![[Pasted image 20230712224243.png]]
```
regripper -r /mnt/windows/Windows/System32/config/SAM -p samparse | grep -i username
```

- Q4
    
    What is the user agent used in the HTTP requests sent by the SQL injection attack tool?
    

![[Pasted image 20230623030946.png]]
```
\xampp\apache\logs\access.log
```

- Q6
    
    What is the NThash of the user's password set by the attacker?
    

![[Pasted image 20230712224316.png]]
```
~/Downloads/volatility_2.6_lin64_standalone/volatility_2.6_lin64_standalone -f memdump.mem --profile=Win2008SP1x86 hashdump
```

- Q7
    
    The attacker uploaded a simple command shell through file upload vulnerability. Provide the name of the URL parameter used to execute commands?
    

![[Pasted image 20230623032408.png]]

- Q8
    
    The attacker used Command Injection to add user "hacker" to the "Remote Desktop Users" Group. Provide the IP address that was part of the executed command?
    

![[Pasted image 20230623033431.png]]
```
~/Downloads/volatility_2.6_lin64_standalone/volatility_2.6_lin64_standalone -f memdump.mem --profile=Win2008SP1x86 pstree
```
![[Pasted image 20230712224421.png]]
```
~/Downloads/volatility_2.6_lin64_standalone/volatility_2.6_lin64_standalone -f memdump.mem --profile=Win2008SP1x86 memdump --pid 2880 -D .
```

- Q9
    
    The attacker dropped a shellcode through SQLi vulnerability. The shellcode was checking for a specific version of PHP. Provide the PHP version number?

![[Pasted image 20230623033558.png]]
![[Pasted image 20230623033641.png]]
![[Pasted image 20230623033710.png]]

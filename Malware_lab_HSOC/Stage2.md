
```
sudo mount -t ntfs-3g -o loop,ro,show_sys_files,stream_interface=windows,offset=$((2048*512)) ./challenge /mnt/windows/
```


- Q1
    
    What is the computer's name?
    

![Pasted image 20230712223643](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/5b3ba7a6-77de-4264-be95-33f37aa7c882)
```
sudo vol -f memdump.mem windows.envars | grep -i computername
```
![Pasted image 20230712223755](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/1ed1f48b-c492-465f-bd84-ba29a57836d3)
```
~/Downloads/volatility_2.6_lin64_standalone/volatility_2.6_lin64_standalone -f memdump.mem --profile=Win2008SP1x86 printkey -K "ControlSet001\Control\ComputerName\ComputerName"
```
![Pasted image 20230712223840](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/2ca5acbe-9aa4-42a5-91f3-8016f7f9811f)
```
regripper -r /mnt/windows/Windows/System32/config/SYSTEM -p compname
```

- Q2
    
    What was the first vulnerability the attacker was able to exploit?
    

![Pasted image 20230623025054](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/5d18a34a-e0b2-45b3-abda-531e903ec4f3)
```
\xampp\apache\logs\access.log
```

- Q3
    
    How many users are on the compromised machine?
    

![Pasted image 20230712224243](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/c2a0168c-08d9-4371-bdb6-87b0b70406f6)
```
regripper -r /mnt/windows/Windows/System32/config/SAM -p samparse | grep -i username
```

- Q4
    
    What is the user agent used in the HTTP requests sent by the SQL injection attack tool?
    

![Pasted image 20230623030946](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/ce6aaf1d-597f-4fab-b462-74b878f7d0d4)

```
\xampp\apache\logs\access.log
```

- Q6
    
    What is the NThash of the user's password set by the attacker?
    

![Pasted image 20230712224316](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/d877608f-ee61-4246-9795-b619b160bd2b)
```
~/Downloads/volatility_2.6_lin64_standalone/volatility_2.6_lin64_standalone -f memdump.mem --profile=Win2008SP1x86 hashdump
```

- Q7
    
    The attacker uploaded a simple command shell through file upload vulnerability. Provide the name of the URL parameter used to execute commands?
    

![Pasted image 20230623032408](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/1e231f44-114b-46ed-a606-a66d7f712fe2)

- Q8
    
    The attacker used Command Injection to add user "hacker" to the "Remote Desktop Users" Group. Provide the IP address that was part of the executed command?
    

![Pasted image 20230623033431](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/115229d1-5b9a-4212-b5cb-6647140b8369)
```
~/Downloads/volatility_2.6_lin64_standalone/volatility_2.6_lin64_standalone -f memdump.mem --profile=Win2008SP1x86 pstree
```
![Pasted image 20230712224421](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/a7b43090-3416-48df-950a-142e7024ef01)
```
~/Downloads/volatility_2.6_lin64_standalone/volatility_2.6_lin64_standalone -f memdump.mem --profile=Win2008SP1x86 memdump --pid 2880 -D .
```

- Q9
    
    The attacker dropped a shellcode through SQLi vulnerability. The shellcode was checking for a specific version of PHP. Provide the PHP version number?

![Pasted image 20230623033558](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/ccc125aa-a3c0-4dc1-806c-12ba00f9a385)

![Pasted image 20230623033641](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/c6caeb56-14d8-48fb-9dee-67c33b8c025b)

![Pasted image 20230623033710](https://github.com/tsof-smoky/writeup-CTF-challenge/assets/107832241/eb72bacf-3ff4-44d4-967f-95b8d43194f4)

